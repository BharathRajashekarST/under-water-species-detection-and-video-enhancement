<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player with Detect Button</title>
</head>
<body>
    <h1>Video Player</h1>

    <style>
        /* Set the width of the video player to 100% of the viewport width */
        #videoPlayer1 {
            width: 99vw; /* Set the width to 100% of the viewport width */
            height: 460px; /* Let the height adjust automatically based on aspect ratio */
        }

        #videoPlayer2 {
            width: 99vw; /* Set the width to 100% of the viewport width */
            height: 460px; /* Let the height adjust automatically based on aspect ratio */
        }
    </style>
    
    <!-- Video Player 1 -->
    <video id="videoPlayer1" controls>
        <source src="" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- File input field to browse for video -->
    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" id="videoFile" name="videoFile" accept="video/mp4,video/x-matroska,video/quicktime,video/x-msvideo">
        <input type="submit" value="Upload" id="uploadButton" >
    </form>

    <!-- Detect Button -->
    <button id="detectButton">Detect</button>

    <!-- Video Player 2 (Initially hidden) -->
    <div id="videoPlayer2Container" style="display: none;">
        <h2>Video Player 2</h2>
        <video id="videoPlayer2" controls>
            <source src="" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch('/upload_video', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                var file = document.getElementById('videoFile').files[0];
                var videoPlayer = document.getElementById('videoPlayer1');
                videoPlayer.src = URL.createObjectURL(file);
                /*
                var videoPlayer1 = document.getElementById('videoPlayer1');
                var fileInput = document.getElementById('videoFile');
                var fileName = fileInput.value.split('\\').pop();
                videoPlayer1.src = "videos/"+fileName;
                console.log("videos/"+fileName);*/
                
            })
            .catch(error => console.error('Error:', error));
        });
        /*
        document.getElementById('videoFile').addEventListener('change', function(event) {
            var file = this.files[0];
            var videoPlayer = document.getElementById('videoPlayer1');
            videoPlayer.src = URL.createObjectURL(file);
        });
        */
        document.getElementById('detectButton').addEventListener('click', function(event) {
            fetch('/get_second_video_location') // Change this URL to match your Flask route
                .then(response => response.json())
                .then(data => {
                    var videoPlayer2Container = document.getElementById('videoPlayer2Container');
                    var videoPlayer2 = document.getElementById('videoPlayer2');
                    videoPlayer2.src = data.videoLocation;
                    videoPlayer2Container.style.display = 'block';
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
